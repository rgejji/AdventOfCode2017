package main

import (
	"fmt"
	"strings"
)

const (
	up = iota
	right
	down
	left
)

var (
	numRows int
	numCols int
)

func main() {
	grid := makeGrid()

	startRow, startCol := findStart(grid)
	letters, numSteps := trackGrid(grid, startRow, startCol)
	fmt.Printf("%s %d\n", string(letters), numSteps)

	//fmt.Println("vim-go")
}

func trackGrid(grid [][]rune, startRow int, startCol int) ([]rune, int) {
	currRow := startRow
	currCol := startCol
	currDir := down

	chars := []rune{}
	count := 0
	for {
		//fmt.Printf("Curr loc is %d, %d with direction %v\n", currRow, currCol, currDir)
		currChar := grid[currRow][currCol]
		if currChar == ' ' {
			fmt.Printf("Warning: Went off the path at location (%d, %d) with direction %d\n", currRow, currCol, currDir)
			return chars, count
		}

		if currChar != '+' && currChar != '|' && currChar != '-' {
			chars = append(chars, currChar)
		}

		switch currDir {
		case down:
			if currChar == '+' {
				if currCol > 0 && grid[currRow][currCol-1] != ' ' {
					currCol--
					currDir = left
				} else if currCol+1 < numCols && grid[currRow][currCol+1] != ' ' {
					currCol++
					currDir = right
				} else {
					fmt.Printf("ERROR: CANNOT PROCESS VALUE AT GRID (%d,%d) given dir %v\n", currRow, currCol, currDir)

				}
			} else {
				if currRow+1 == numRows {
					return chars, count
				}
				currRow++
			}

		case up:
			if currChar == '+' {
				if currCol+1 < numCols && grid[currRow][currCol+1] != ' ' {
					currCol++
					currDir = right
				} else if currCol > 0 && grid[currRow][currCol-1] != ' ' {
					currCol--
					currDir = left
				} else {
					fmt.Printf("ERROR: CANNOT PROCESS VALUE AT GRID (%d,%d) given dir %v\n", currRow, currCol, currDir)
				}
			} else {
				if currRow == 0 {
					return chars, count
				}
				currRow--
			}
		case right:
			if currChar == '+' {
				if currRow+1 < numRows && grid[currRow+1][currCol] != ' ' {
					currRow++
					currDir = down
				} else if currRow > 0 && grid[currRow-1][currCol] != ' ' {
					currRow--
					currDir = up
				} else {
					fmt.Printf("ERROR: CANNOT PROCESS VALUE AT GRID (%d,%d) given dir %v\n", currRow, currCol, currDir)
				}
			} else {
				if currCol+1 >= numCols {
					return chars, count
				}
				currCol++
			}
		case left:
			if currChar == '+' {
				if currRow > 0 && grid[currRow-1][currCol] != ' ' {
					currRow--
					currDir = up
				} else if currRow+1 < numRows && grid[currRow+1][currCol] != ' ' {
					currRow++
					currDir = down
				} else {
					fmt.Printf("ERROR: CANNOT PROCESS VALUE AT GRID (%d,%d) given dir %v\n", currRow, currCol, currDir)
				}
			} else {
				if currCol <= 0 {
					return chars, count
				}
				currCol--
			}

		default:
			fmt.Printf("UNKNWON DIRECTION: %v", currDir)
		}
		count++
	}
	return chars, count
}

func findStart(grid [][]rune) (int, int) {
	for j := 0; j < numCols; j++ {
		if grid[0][j] == '|' {
			fmt.Printf("Start is at (%d,%d)\n", 0, j)
			return 0, j
		}
	}
	fmt.Printf("Unable to find start\n")
	return 0, 0

}

func makeGrid() [][]rune {
	//Make grid
	lines := strings.Split(inputStr, "\n")
	numRows = len(lines)
	numCols = len(lines[0])
	grid := make([][]rune, numRows, numRows)

	//Input values
	for i, line := range lines {
		grid[i] = make([]rune, numCols, numCols)
		fmt.Printf("Row %d has %d characters\n", i, len(line))
		for j, char := range line {
			grid[i][j] = char
		}
	}
	return grid
}

const (
	/*inputStr = `     |
	    |  +--+
	    A  |  C
	F---|--|-E---+
	    |  |  |  D
	    +B-+  +--+ `*/

	inputStr = `                                                                                                                                                                   |                                     
   +-------+                   +---------------------+                     +-----------+                         +---------------------------------------+         |                                 +-+ 
   |       |                   |                     |                     |           |                         |                                       |         |                                 | | 
   |       |   +---------------|---------------------|-----------------------------------------------------------------------------+           +---------------------+                               | | 
   |       |   |               |                     |                     |           |                         |                 |           |         |         | |                               | | 
   |   +-----------------+ +---+     +-----------+   |                     |           |                         |   +-------------+           |         |         | |                               | | 
   |   |   |   |         | |         |           |   |                     |           |                         |   |                         |         |         | |                               | | 
   |   |   | +-|---------|-----------|---------+ +-----------+             |           +-----------------------------|-------+                 |         |         | |                               | | 
   |   |   | | |         | |         |         |     |       |             |                                     |   |       |                 |         |         | |                               | | 
   |   |   | | |         +---+       |     +-------------------------------|-------------------------------------|-----------------------------+         |         | |                 +-------------+ | 
   |   |   | | |           | |       |     |   |     |       |             |                                     |   |       |                           |         | |                 |               | 
   |   |   | | |           | |     +-|-----|---|---------------------------|-----------+                         |   |       |                           |         | |                 |               | 
   |   |   | | |           | |     | |     |   |     |       |             |           |                         |   |       |                           |         | |                 |               | 
   |   |   | | |           | |     | |     |   +-----|-----+ |             |           |                 +-------|---|-------+                           |         | |                 |               | 
   |   |   | | |           | |     | |     |         |     | |             |           |                 |       |   |                                   |         | |                 |               | 
   |   |   | | |           | |     | |     |         |     +-|-------------------------+       +---------|-------|---------------------------------------|---------|-------------------|-+     +-+     | 
   |   |   | | |           | |     | |     |         |       |             |                   |         |       |   |                                   |         | |                 | |     | |     | 
   |   |   | +-|-------------|-----|-----------------------+ |             |                   |         |       |   |                                   |         | |                 | |     +-|-+   | 
   |   |   |   |           | |     | |     |         |     | |             |                   |         |       |   |                                   |         | |                 | |       | |   | 
   |   |   |   |           | |     | |     |   +-----|-------|-------------|-------------------|---------+       |   |                     +-------------|---------|I|-------------------------+ | |   | 
   |   |   |   |           | |     | |     |   |     |     | |             |                   |                 |   |                     |             |         | |                 | |     | | |   | 
   |   |   |   |           | |     | |     |   |     |     | |             |                   | +-----------+   |   |               +-----|------C------------------------------------+ |     | | |   | 
   |   |   |   |           | |     | |     |   |     |     | |             |                   | |           |   |   |               |     |             |         | |                   |     | | |   | 
   |   |   |   |   +-------|---------|-----|---------------|-|-------------|---------+         | |           |   +---|-------+       |     |   +---------|-----+   | |               +-+ |     | | |   | 
   |   |   |   |   |       | |     | |     |   |     |     | |             |         |         | |           |       |       |       |     |   |         |     |   | |               | | |     | | |   | 
   |   |   |   |   |       +-------|-|-----|---|-----|---------------------|---------|---------|-------------|---+   |       |       |     |   |         |     |   | |               | | |   +---+ |   | 
   |   |   |   |   |         |     | |     |   |     |     | |             |         |         | |           |   |   |       |       |     |   |         |     |   | |               | | |   | |   |   | 
   |   |   |   +-------------------|-|---------------------+ |         +-----------------------|-----------------|---|---------------------|-----------------------------------------|-|-------|-+ |   | 
   |   |   |       |         |     | |     |   |     |       |         |   |         |         | |           |   |   |       |       |     |   |         |     |   | |               | | |   | | | |   | 
   |   |   |       |         |     | |     |   |     |       |         |   |         |         | |           |   |   +---------------|---------|N--------------|-----+               | | |   | | | |   | 
   |   |   |       |         |     | |     |   |     |       |         |   |         |         | |           |   |           |       |     |   |         |     |   |                 | | |   | | | |   | 
   |   |   |   +-----------+ |     | |     +---|-----|-----------------|---+         |         | |         +-|---|-------------------|---------|---------|-----|---|-----------------|-|-|---+ | | |   | 
   |   |   |   |   |       | |     | |         |     |       |         |             |         | |         | |   |           |       |     |   |         |     |   |                 | | |     | | |   | 
   |   |   |   |   |       | |     | |         |     |       |         |             |         | |         | |   |           |       |     |   |         |     |   |                 | | |     | | |   | 
   |   |   |   |   |       | |     | |         |     |       |         |             |         | |         | |   |           |       |     |   |         |     |   |                 | | |     | | |   | 
   |   |   |   |   +-------|-|---+ | |         |     |       |         |             |         | |         | |   |           |       |     |   |         |     |   |                 | | |     | | |   | 
   |   |   |   |           | |   | | |         |     |       |         |             |         | |         | |   |           |       |     |   |         |     |   |                 | | |     | | |   | 
   |   |   |   |           | +-+ | | |         |     |       |         |   +-------------------|---------+ | |   |           |       |     |   |         |     |   |                 | | |     | | |   | 
   |   |   |   |           |   | | | |         |     |       |         |   |         |         | |       | | |   |           |       |     |   |         |     |   |                 | | |     | | |   | 
   +---|-------|---------------|---|-|-----------+   |       |         |   |         |         | |       | | |   |           |       |     |   |         |     |   |                 | | |     | | |   | 
       |   |   |           |   | | | |         | |   |       |         |   |         |         | |       | | |   |           |       |     |   |         |     |   |                 | | |     | | |   | 
       |   |   |           |   +---|-+         | |   |       |         |   |   +-+   |         | |       +-+ |   +-------------------------|-----------------------|-----------------|---+     | | |   | 
       |   |   |           |     | |           | |   |       |         |   |   | |   |         | |           |               |       |     |   |         |     |   |                 | |       | | |   | 
       |   |   |           |     | |           | |   |       |         |   |   | |   | +-------|-------------|---------------|-------------|-------------------|-------------------+ | |       | | |   | 
       |   |   |           |     | |           | |   |       |         |   |   | |   | |       | |           |               |       |     |   |         |     |   |               | | |       | | |   | 
       |   |   |   +-------|-----|-------+     | |   |       |         |   |   | |   | |       | |           |               |       |     |   |         |     |   |               | | |       | | +-+ | 
       |   |   |   |       |     | |     |     | |   |       |         |   |   | |   | |       | |           |               |       |     |   |         |     |   |               | | |       | |   | | 
       |   |   |   |       |     | |     |     | |   |       +---------|---------------|---------|-----------|-----------------------------|-------------|---------|---------------|-|-----------|---+ | 
       |   |   |   |       |     | |     |     | |   |                 |   |   | |   | |       | |           |               |       |     |   |         |     |   |               | | |       | |     | 
       |   |   |   |       +-----|-|-----|-----|-----|-------+         |   |   | |   | |       | |       +-----------------------+   |     |   |         |     |   |               | | |     +-------+ | 
       |   |   |   |             | |     |     | |   |       |         |   |   | |   | |       | |       |   |               |   |   |     |   |         |     |   |               | | |     | | |   | | 
       |   |   |   |             | |     |     | |   |       |         |   |   | |   | | +-----------------------------------|---|-------------|---------|-----|-------------------------------|-+ +-+ | 
       |   |   |   |             | |     |     | |   |       |         |   |   | |   | | |     | |       |   |               O   |   |     |   |         |     |   |               | | |     | |   |   | 
       |   |   |   |     +-------|-------|-----------|-------|-------------|-----|---|-|-------|---------|---|-------------------|-----------------------------|-----------------+ | | |     | |   |   | 
       |   |   |   |     |       | |     |     | |   |       |         |   |   | |   | | |     | |       |   |               |   |   |     |   |         |     |   |             | | | |     | |   |   | 
       |   |   |   |     |       | |     |     | |   |       |         |   |   | |   | | |     | |       |   |       +-+     |   |   |     |   |         |     |   |             | | | |     | |   |   | 
       |   |   |   |     |       | |     |     | |   |       |         |   |   | |   | | |     | |       |   |       | |     |   |   |     |   |         |     |   |             | | | |     | |   |   | 
       |   |   |   |     |   +---|-|-----|-----|-|--R|-------|-------------|---|---------------|-------------|-------|-|---------|---------|---|---------|---------|-----------------|-|-----------|-+ | 
       |   |   |   |     |   |   | |     |     | |   |       |         |   |   | |   | | |     | |       |   |       | |     |   |   |     |   |         |     |   |             | | | |     | |   | | | 
       |   |   |   |   +-----+   | |     |     | |   |       |         |   |   | |   | | |     | |       +---------------------------|-------------------|-----------------------+ | | |     | |   | | | 
       |   |   |   |   | |       | |     |     | |   |       |         |   |   | |   | | |     | |           |       | |     |   |   |     |   |         |     |   |               | | |     | |   | | | 
       |   |   |   |   | |       | |     |     | |   |     +-----------|-------|-|-------|-------|-----------|-------|-------|-------------|---------------------------------+     | +-------+ |   | | | 
       |   |   |   |   | |       | |     |     | |   |     | |         |   |   | |   | | |     | |           |       | |     |   |   |     |   |         |     |   |         |     |   |       |   | | | 
       |   |   |   |   | |       | +-----|-------|---------|-----------|---|-----|-------------|-|---------------------------------+ |     |   |         |     |   |         |   +-----|-------|---+ | | 
       |   |   |   |   | |       |       |     | |   |     | |         |   |   | |   | | |     | |           |       | |     |   | | |     |   |         |     |   |         |   | |   |       |     | | 
       |   |   | +---------------|-------|S------|---|-----+ |         |   |   | |   | | |     | |   +-------|---------|---------|---------|---|-------+ +---------|-------------+ |   |       |     | | 
       |   |   | | |   | |       |       |     | |   |       |         |   |   | |   | | |     | |   |       |       | |     |   | | |     |   |       |       |   |         |     |   |       |     | | 
       |   |   | | |   | |   +-----------------|-----|-------|-------------|-----|---|---|-----|-|-----------|-------|-|-----|---|-|-+     |   |       |       |   |         |     |   |       |     | | 
       |   |   | | |   | |   |   |       |     | |   |       |         |   |   | |   | | |     | |   |       |       | |     |   | |       |   |       |       |   |         |     |   |       |     | | 
       |   |   | | +-------------|-------------|-|---|-------|-------------|---------|-------------------------------|-------|-------------|-------+   |       |   |         |     |   |       |     | | 
       |   |   | |     | |   |   |       |     | |   |       |         |   |   | |   | | |     | |   |       |       | |     |   | |       |   |   |   |       |   |         |     |   |       |     | | 
       | +-|---|-|-----|-|---------------|-------|-----------|-------------------|-------------|-|---------------------|-----|---|-|-------|-------|---|---------+ |         |     |   |       |     | | 
       | | |   | |     | |   |   |       |     | |   |       |         |   |   | |   | | |     | |   |       |       | |     |   | |       |   |   |   |       | | |         |     |   |       |     | | 
       | | |   | |     | |   | +---------|-----|-|-------+   |         |   |   | |   | | |     | |   |       |       | |     |   +-------------|-----------------|-----+     |     |   |       |     | | 
       | | |   | |     | |   | | |       |     | |   |   |   |         |   |   | |   | | |     | |   |       |       | |     |     |       |   |   |   |       | | |   |     |     |   |       |     | | 
       | | |   | |     | |   | | |       |     | |   |   |   |       +-|---|---|---------|-------|-------------------------------------------------|---|-----+ | | |   |     |     |   |       |     | | 
       | | |   | |     | |   | | |       |     | |   |   |   |       | |   |   | |   | | |     | |   |       |       | |     |     |       |   |   |   |     | | | |   |     |     |   |       |     | | 
       | | |   | |     | |   | | |       |     | |   |   |   |       | |   |   | |   | | |     | |   |       |     +-|-|-----------|-------------------+     | | | |   |     |     |   |       |     | | 
       | | |   | |     | |   | | |       |     | |   |   |   |       | |   |   | |   | | |     | |   |       |     | | |     |     |       |   |   |         | | | |   |     |     |   |       |     | | 
       | | |   | |     | |   | | +---+   |     | |   |   |   |       | +-+ |   | |   | +-+ +---|-|---|-------|-----|-|-------------|-----------|---|---------|-|-------|-----|---------|-------------|-+ 
       | | |   | |     | |   | |     |   |     | |   |   |   |       |   | |   | |   |     |   | |   |       |     | | |     |     |       |   |   |         | | | |   |     |     |   |       |     |   
       | | |   | |     | |   | |     |   |     | |   |   |   |       |   | |   | |   |     |   | |   |       |     | | |     |     |       |   |   |         | | | |   |     | +-------|-------|-----+   
       | | |   | |     | |   | |     |   |     | |   |   |   |       |   | |   | |   |     |   | |   |       |     | | |     |     |       |   |   |         | | | |   |     | |   |   |       |         
   +---|-|-|---|-------|-|-----|---------|-----|-----|---|---+       |   | |   | |   |     | +-|-|---|-------|-----|---|-----------|---+   |   |   |         | | | |   |     | |   |   |       |         
   |   | | |   | |     | |   | |     |   |     | |   |   |           |   | |   | |   |     | | | |   |       |     | | |     |     |   |   |   |   |         | | | |   |     | |   |   |       |         
   |   | +-------|-----|-|-----|-----|---|-----------|-------------------|-|---|-----|-----|-+ | |   |       |     | | |     |     +-----------|---|-------+ | | | |   |     | |   |   |       |         
   |   |   |   | |     | |   | |     |   |     | |   |   |           |   | |   | |   |     |   | |   |       |     | | |     |         |   |   |   |       | | | | |   |     | |   |   |       |         
   | +-+   |   | |     | |   | |     |   |     | |   |   |           |   | |   | |   |     |   | |   |       |     | | |     |         |   |   |   |       | | | | |   |     | |   |   |       |         
   | |     |   | |     | |   | |     |   |     | |   |   |           |   | |   | |   |     |   | |   |       |     | | |     |         |   |   |   |       | | | | |   |     | |   |   |       |         
   | |   +-----|-------|-|---|-|-+   |   +-----|---------------------|-----|---|-----|-----|---|-|---|-------------------------+       |   |   |   +-------|---|-|-|---|-----+ |   |   |       |         
   | |   | |   | |     | |   | | |   |         | |   |   |           |   | |   | |   |     |   | |   |       |     | | |     | |       |   |   |           | | | | |   |       |   |   |       |         
   | |   | |   | |     | |   | | +-------------------|---------------------------|---------+ +---|-----------+     +-|-+     | +-------|-+ |   |           | | | | |   |       |   |   |       |         
   | |   | |   | |     | |   | |     |         | |   |   |           |   | |   | |   |       | | |   |               |       |         | | |   |           | | | | |   |       |   |   |       |         
   | |   | |   | |     | |   | |     |         | |   |   +---------------|---------------------------------------------+     |         | | |   |           | | | | |   |       |   |   |       |         
   | |   | |   | |     | |   | |     |         | |   |               |   | |   | |   |       | | |   |               | |     |         | | |   |           | | | | |   |       |   |   |       |         
   | |   | |   | |     | |   | |     |         | |   |               |   | |   | |   |       | | |   |               | |     |         | | |   |           | | | | |   |       |   |   |       |         
   | |   | |   | |     | |   | |     |         | |   |               |   | |   | |   |       | | |   |               | |     |         | | |   |           | | | | |   |       |   |   |       |         
   | |   | |   | |     | |   | |     |         | |   |               |   | |   | |   |   +---|---|---|-----------------|-----|-----------|-|---------------|-|---+ |   |       |   |   |     +-|-------+ 
   | |   | |   | |     | |   | |     |         | |   |               |   | |   | |   |   |   | | |   |               | |     |         | | |   |           | | |   |   |       |   |   |     | |       | 
 +---|-----|---|-|-----|-|-----|-----|--U--------|---|-----------------------+ | |   |   |   | | |   |               | |     |         | | |   |           | | |   |   |       |   |   |     | |       | 
 | | |   | |   | |     | |   | |     |         | |   |               |   | | | | |   |   |   | | |   |               | |     |         | | |   |           | | |   |   |       |   |   |     | |       | 
 | | |   | |   | |     | |   | |     |         | |   |               |   | | | +-----------+ | | |   |               | |     |         | | |   |           | | |   |   +-----+ |   +---|-+   | |       | 
 | | |   | |   | |     | |   | |     |         | |   |               |   | | |   |   |   | | | | |   |               | |     |         | | |   |           | | |   |         | |       | |   | |       | 
 | | |   | |   | |     | |   | |     |         | |   |         +-----|---|-|---------|---|-|-|-+ |   |               | |     |         | | |   |           | | |   |       +---+       | |   | |       | 
 | | |   | |   | |     | |   | |     |         | |   |         |     |   | | |   |   |   | | |   |   |               | |     |         | | |   |           | | |   |       | |         | |   | |       | 
 | | |   | |   | |     | |   | |     |         | |   |         |     |   | | |   |   |   | | |   | +-----------------+ |     |         | | |   |           | | |   |       | |         | |   | |       | 
 | | |   | |   | |     | |   | |     |         | |   |         |     |   | | |   |   |   | | |   | | |                 |     |         | | |   |           | | |   |       | |         | |   | |       | 
 | | |   | |   | | +---|-|D--|-------+ +---------|---|---------|-----|-----|---------|---|-|---+ | | |                 |     |         | +-|---------------|---------------|-|---------|-|---|-------+ | 
 | | |   | |   | | |   | |   | |       |       | |   |         |     |   | | |   |   |   | | | | | | |                 |     |         |   |   |           | | |   |       | |         | |   | |     | | 
 | | |   | |   | | |   | |   | |       |       | |   |         |     |   | | |   |   | +---|---|-|-|-------------------|-----------------------+           | | |   |       | |         | |   | |     | | 
 | | |   | |   | | |   | |   | |       |       | |   |         |     |   | | |   |   | | | | | | | | |                 |     |         |   |               | | |   |       | |         | |   | |     | | 
 | | |   | |   | | +---|-------|---+   +-------|-|---|---------|-----+   | | |   |   | | | | | | | | |                 |     |         |   |               | | |   |       | |         | |   | |     | | 
 | | |   | |   | |     | |   | |   |           | |   |         |         | | |   |   | | | | | | | | |                 |     |         |   |               | | |   |       | |         | |   | |     | | 
 | | +---|-----|---+   | |   | |   |           +---------------------------------------|-|-|-|-|-|---|-----------------|-----|-------------|---------------------------+   | |   +-----|-----|-------+ | 
 | |     | |   | | |   | |   | |   |             |   |         |         | | |   |   | | | | | | | | |                 |     |         |   |               | | |   |   |   | |   |     | |   | |       | 
 | |     | | +---|-+   | |   | |   |             |   |         |         | | |   |   | | | | | | | | |                 |     |         |   |               | | |   |   |   | |   |     | |   | |       | 
 | |     | | | | |     | |   | |   |             |   |         |         | | |   |   | | | | | | | | |                 |     |         |   |               | | |   |   |   | |   |     | |   | |       | 
 | |     | | | | |     | |   | |   |             +-------------|---------|---|-------|---|-|-|---|---|-----------------|-----|---------|-----------------------|-------|---|-----|-------|---|-+       | 
 | |     | | | | |     | |   | |   |                 |         |         | | |   |   | | | | | | | | |                 |     |         |   |               | | |   |   |   | |   |     | |   |         | 
 | |     | | | | | +---|-|---------|-----------------|---------|---------|-|-----+   | | | | | | | | |                 |     |         |   |               | | |   |   |   | |   +-----------|-----+   | 
 | |     | | | | | |   | |   | |   |                 |         |         | | |       | | | | | | | | |                 |     |         |   |               | | |   |   |   | |         | |   |     |   | 
 | |     | | | | | |   | |   | |   |                 |         |         | | |       +-|-|---|-|-----+                 |     |         |   |   +-----------|-------|---|---|-+ +-------|-----|-----|-+ | 
 | |     | | | | | |   | |   | |   |                 |         |         | | |         | | | | | | |                   |     |         |   |   |           | | |   |   |   |   |       | |   |     | | | 
 | |     | | | | | |   | |   | |   |                 |   +---------------|---|---------|-|-----|-|-|-------------------|---------------|---|---------------|-|-|---|-------|-----+     | |   |     | | | 
 | |     | | | | | |   | |   | |   |                 |   |     |         | | |         | | | | | | |                   |     |         |   |   |           | | |   |   |   |   | |     | |   |     | | | 
 | |     | | | | | |   | |   | |   |                 |   |     |         | | |         | | | | +-|-|-------------------|-----|---------------+ +-----------|-|---------|-------|---------|---|-----|-+ | 
 | |     | | | | | |   | |   | |   |                 |   |     |         | | |         | | | |   | |                   |     |         |   | |             | | |   |   |   |   | |     | |   |     |   | 
 | |     | | | | | |   | |   | |   |                 |   |     |         | | |         | | | |   | |       +-----------+     |         |   | |             | | |   |   |   |   | |     | |   |     |   | 
 | |     | | | | | |   | |   | |   |                 |   |     |         | | |         | | | |   | |       |                 |         |   | |             | | |   |   |   |   | |     | |   |     |   | 
 | |     | | | +---------|---|-|---|---------+       |   |     |         | | |   +-------|-|---------------|---------------------------|---|-----------------|-----+   |   |   | |     | |   |     |   | 
 | |     | | |   | |   | |   | |   |         |       |   |     |         | | |   |     | | | |   | |       |                 |         |   | |             | | |       |   |   | |     | |   |     |   | 
 | +-------+ |   | |   | |   | |   |         +---------------------------|-------------|---|---------------|---------------------------------------------------|---------------|-|-----------------|-+ | 
 |       |   |   | |   | |   | |   |                 |   |     |         | | |   |     | | | |   | |       |                 |         |   | |             | | |       |   |   | |     | |   |     | | | 
 |       |   |   | |   | |   | |   |                 |   |     |         | | |   +-----|-|---|-----------------------------------------|-------------------|-|-------------------+     | |   |     | | | 
 |       |   |   | |   | |   | |   |                 |   |     |         | | |         | | | |   | |       |                 |         |   | |             | | |       |   |   |       | |   |     | | | 
 |       |   |   | |   | |   | |   |                 |   |     |         | | |         | | | |   | |       |                 |         |   +-|---------------|-------------|---|-------|-|---|-----|---+ 
 |       |   |   | |   | |   | |   |                 |   |     |         | | |         | | | |   | |       |                 |         |     |             | | |       |   |   |       | |   |     | |   
 |       | +-------|---|-|---------------------------|---|---------------|---|---------|-----------|-------------------------|---------|-----|-+           | | |       |   |   |       | |   |     | |   
 |       | | |   | |   | |   | |   |                 |   |     |         | | |         | | | |   | |       |                 |         |     | |           | | |       |   |   |       | |   |     | |   
 |       | | +---|-----------|-------------+         |   |     |         | | |         | | | |   | |       |                 |         |     | +-------------|-------------|---------+ | |   |     | |   
 |       | |     | |   | |   | |   |       |         |   |     |         | | |         | | | |   | |       |                 |         |     |             | | |       |   |   |     | | |   |     | |   
 |       | |     | |   | |   | |   |       |         |   |     |         | | |         | | | |   | |       |                 |         |     |       +-----|---+       |   |   |     | | |   |     | |   
 |       | |     | |   | |   | |   |       |         |   |     |         | | |         | | | |   | |       |                 |         |     |       |     | |         |   |   |     | | |   |     | |   
 |       | |     | |   +-|-----|---|---------------------|---------------|-|-|---------|---|-|---|---------------------------|-----------------------|-----------------|-------------|-|-+   |     | |   
 |       | |     | |     |   | |   |       |         |   |     |         | | |         | | | |   | |       |                 |         |     |       |     | |         |   |   |     | |     |     | |   
 |       | |     | |     |   | |   |       |         |   |     |         | | |         | | | |   | +-----------------------------------|-+   |       |     | |         |   |   |     | |     |     | |   
 |       | |     | |     |   | |   |       |         |   |     |         | | |         | | | |   |         |                 |         | |   |       |     | |         |   |   |     | |     |     | |   
 |       | |     | |     |   | |   |       |         |   |     |         | | |         | | | |   |         |                 |         | |   |       |     | |         |   |   |     | |     |     | |   
 |       | |     | |     |   | |   |       |         |   |     |         | | |         | | | |   |         |                 |         | |   |       |     | |         |   |   |     | |     |     | |   
 |       | |     | |     |   | | +---------+         |   |     |         | | |         | | | |   |         |                 |         | |   |       |     | |         |   |   |     | |     |     | |   
 |       | |     | |     |   | | | |                 |   |     |         | | |         | | | |   |         |                 |         | |   |       |     | |         |   |   |     | |     |     | |   
 |       | |     | |     |   | | | |       +---------------------------------|---------------+   |         | +---------------|-----------------------|-----|-|---------|---------------|-----------|-|-+ 
 |       | |     | |     |   | | | |       |         |   |     |         | | |         | | |     |         | |               |         | |   |       |     | |         |   |   |     | |     |     | | | 
 | +-------------|-|-----------------------+         |   +-----|---------|-----------------|-----|-+       | |               |         | |   |       |     | |         |   |   |     | |     |     | | | 
 | |     | |     | |     |   | | | |                 |         |         | | |         | | |     | |       | |               |         | |   |       |     | |         |   |   |     | |     |     | | | 
 | |     | |     | |     |   | | | |                 |         |         | | |         | | |     | |       | |               |         | |   |       |     | |         |   |   |     | |     |     | | | 
 | |     | |     | |     |   | | | |                 |         |         | | |         | | |     | |       | |               |         | |   |       |     | |         |   |   |     | |     |     | | | 
 | |     | |     | |     |   | | | |                 |         |         | | |         | | | +---|-|-------|-|-------------------------|-----|-------------|-----------|---|-----+   | |     |     | | | 
 | |     | |     | |     |   | | | |                 |         |         | | |         | | | |   | |       | |               |         | |   |       |     | |         |   |   | |   | |     |     | | | 
 | |     | |     | |     |   | | | |                 |   +-----------------|-----------|-------------------|-|---------------|---------|-|-----------------|-|---------|---|-----+   | |     |     | | | 
 | |     | |     | |     |   | | | |                 |   |     |         | | |         | | | |   | |       | |               |         | |   |       |     | |         |   |   |     | |     |     | | | 
 | |     | |     | |     |   | | | |                 |   +-----|-----------|-|---------|---|-----|-+       | |       +-------|---------|---------------------------------------|-----|---+   |     | | | 
 | |     | |     | |     |   | | | |                 |         |         | | |         | | | |   |         | |       |       |         | |   |       |     | |         |   |   |     | | |   |     | | | 
 | +-----|-------+ |     +---|---+ |                 |         |         | | |         | | | |   |         | |       |     +-|---------------|-------|-------------------------|-----|-|---+ |     | | | 
 |       | |       |         | |   |                 |         |         | | |         | | | |   |         | |       |     | |         | |   |       |     | |         |   |   |     | | | | |     | | | 
 |   +-----|-----------------|-|---|-----------------|---------|---------|-------------|---|---------------|-|-------|-----|-----------|-----|-------------|-----------|---|-----+   | | +-----+   | +-+ 
 |   |   | |       |         | |   |                 |         |         | | |         | | | |   |         | |       |     | |         | |   |       |     | |         |   |   | |   | |   | | |   |     
 |   |   | +-------|-+     +-|-+   |                 |         |         | | |         | | | |   |         | |       |     | |         | |   |       |     | |         |   | +-+ |   | |   | | |   |     
 |   |   |         | |     | |     |                 |         |         | | |         | | | |   |         | |       |     | |         | |   |       |     | |         |   | |   |   | |   | | |   |     
 |   |   |         +-|-----------------------------------------|-------------|-+       +-|-------------+   | |       |     | |         | |   +-------------|-----------|-----|---|---|-|---|-|-|---|---+ 
 |   |   |           |     | |     |                 |         |         | | | |         | | |   |     |   | |       |     | |         | |           |     | |         |   | |   |   | |   | | |   |   | 
 | +-------------------------|-----------------------|---------|-----------|-|-|-----------|-+   |     |   | | +-----------|-|-----------------------------------------|---|-|---|---|-|---|-|-|---+   | 
 | | |   |           |     | |     |                 |         |         | | | |         | |     |     |   | | |     |     | |         | |           |     | |         |   | |   |   | |   | | |       | 
 | | |   | +---------|-----|-|---+ |                 |         |         | | +-----------|-------------|-------|-------------|---------|-|---------+ |     | |         |   | |   |   | |   | | |       | 
 | | |   | |         |     | |   | |                 |         |         | |   |         | |     |     |   | | |     |     | |         | |         | |     | |         |   | |   |   | |   | | |       | 
 | | +---------------------|-----|-------------------|---------|-----------|---------------|-----|---------|---------------+ |         | |         +-----+ | |         |   | |   |   | +-----|-----+   | 
 | |     | |         |     | |   | |                 |         |         | |   |         | |     |     |   | | |     |       |         | |           |   | | |         |   | |   |   |     | | |   |   | 
 +-+     | +---------------+ +---------------------------------------------|---+         | |     |     |   | | |     |       |         | |   +-------|---------------------------+ +-------+ | +-+ |   | 
         |           |           | |                 |         |         | |             | |     |     |   | | |     |       |         | |   |       |   | | |         |   | |     | |       |   | |   | 
   +-----+ +---------------------------------------------------|-----------+             | |     +-------------------|-------|---------+ |   |       |   | | |         |   | +-------|---+   |   | |   | 
   |       |         |           | |                 |         |         |               | |           |   | | |     |       |           |   |       |   | | |         |   |       | |   |   |   | |   | 
   |       +-----+   +-----------|-|-----------------|-------------------+               | |       +---|-------------+     +-----------------|---------------|-------------------+ | |   +-+ |   +-+   | 
   |             |               | |                 |         |                         | |       |   |   | | |           | |           |   |       |   | | |         |   |     | | |     | |         | 
 +-+ +-----------|---------------|-------------------+         |                         | |   +---|---|-------------------|-|-----------|---|-----------|-+ |         |   |     | | |     | |       +-+ 
 |   |           |               | |                           |                         | |   |   |   |   | | |           | |           |   |       |   |   |         |   |     | | |     | |       |   
 | +-------------|-----------------|-----------------------------------------------------|-|---|---|-------|-|-------------|---------------------------------|---------|---|---------------|-+       |   
 | | |           |               | |                           |                         | |   |   |   |   | | |           | |           |   |       |   |   |         |   |     | | |     |         |   
 | | +-----------|-----------------|---------------------------|-----------------------------------|---|---|-|-|-------------------+     |   |       |   |   |         |   |   +-+ | |     |         |   
 | |             |               | |                           |                         | |   |   |   |   | | |           | |     |     |   |       |   |   |         |   |   |   | |     |         |   
 | |             |               | |                           |                         | +-------|---|---|-+ |           +-+     |     | +---------|---|---+         |   +-------+ |     |         |   
 | |             |               | |                           |                         |     |   |   |   |   |                   |     | | |       |   |             |       |     |     |         |   
 | |             |               +-------------------------------------------------------------|---|-------|-----------------------|-----+ +-+       |   |             |       +-----------+         |   
 | |             |                 |                           |                         |     |   |   |   |   |                   |                 |   |             |             |               |   
 +-|-------------------------------------+                     |                         +-----+   +---+   +---+                   +---------------+ +-+ +-------------|---------------------------+ |   
   |             |                 |     |                     |                                                                                   |   |               |             |             | |   
   |             |   +-------------+     +---+                 +---------------------------------------------------------------------------------------|---------------|-------------|-------------+ |   
   |             |   |                       |                                                                                                     |   |               |             |               |   
   +-----------------------------------------------------------------------------------------------------------------------------------------------+ K-+               +-------------+               |   
                 |   |                       |                                                                                                                                                       |   
                 +---+                       +-------------------------------------------------------------------------------------------------------------------------------------------------------+   
                                                                                                                                                                                                         `
)
